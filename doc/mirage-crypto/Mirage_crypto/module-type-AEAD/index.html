<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>AEAD (mirage-crypto.Mirage_crypto.AEAD)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">mirage-crypto</a> &#x00BB; <a href="../index.html">Mirage_crypto</a> &#x00BB; AEAD</nav><h1>Module type <code>Mirage_crypto.AEAD</code></h1><p>Authenticated encryption with associated data.</p><p>This defines a uniform interface of symmetrics cryptographic algorithms which encrypt, and also protect the integrity of the data. Additional data, only used for integrity protection, not encrypted and not part of the ciphertext, can be passed in optionally. This prevents the same ciphertext being used at a different location. See <a href="https://tools.ietf.org/html/rfc5116">RFC 5116</a> for further description.</p></header><dl><dt class="spec type" id="type-key"><a href="#type-key" class="anchor"></a><code><span class="keyword">type</span> key</code></dt><dd><p>The abstract type for the key.</p></dd></dl><dl><dt class="spec value" id="val-authenticate_encrypt"><a href="#val-authenticate_encrypt" class="anchor"></a><code><span class="keyword">val</span> authenticate_encrypt : <span>key:<a href="index.html#type-key">key</a></span> <span>&#45;&gt;</span> <span>nonce:Cstruct.t</span> <span>&#45;&gt;</span> <span>?&#8288;adata:Cstruct.t</span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>authenticate_encrypt ~key ~nonce ~adata msg</code> encrypts <code>msg</code> with <code>key</code> and <code>nonce</code>, and appends an authentication tag computed over the encrypted <code>msg</code>, using <code>key</code>, <code>nonce</code>, and <code>adata</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>nonce</code> is not of the right size.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-authenticate_decrypt"><a href="#val-authenticate_decrypt" class="anchor"></a><code><span class="keyword">val</span> authenticate_decrypt : <span>key:<a href="index.html#type-key">key</a></span> <span>&#45;&gt;</span> <span>nonce:Cstruct.t</span> <span>&#45;&gt;</span> <span>?&#8288;adata:Cstruct.t</span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <span>Cstruct.t option</span></code></dt><dd><p><code>authenticate_decrypt ~key ~nonce ~adata msg</code> splits <code>msg</code> into encrypted data and authentication tag, computes the authentication tag using <code>key</code>, <code>nonce</code>, and <code>adata</code>, and decrypts the encrypted data. If the authentication tags match, the decrypted data is returned.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>nonce</code> is not of the right size.</p></dd></dl></dd></dl></div></body></html>